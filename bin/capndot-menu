#!/usr/bin/env bash

BIN_PATH=~/.local/share/capndot/bin

menu() {
  echo -e "$2" | rofi -dmenu -p "$1…"
}

terminal() {
  alacritty --class=Capndot -e $1
}

remove_menu() {
  case $(menu "Removw" "󰣇  Package\n  Web App") in
  *Package*) terminal $BIN_PATH/pkg-remove ;;
  *Web*) terminal $BIN_PATH/webapp-remove ;;
  *) main_menu ;;
  esac
}

install_menu() {
  case $(menu "Install" "󰣇  Package\n  Web App") in
  *Package*) terminal $BIN_PATH/pkg-install ;;
  *Web*) terminal $BIN_PATH/webapp-install ;;
  *) main_menu ;;
  esac
}

learn_menu() {
  case $(menu "Learn" "  Keybindings\n  Hyprland\n󰣇  Arch\n  Neovim\n󱆃  Bash") in
  *Keybindings*) $BIN_PATH/keybindings ;;
  *Hyprland*) setsid chromium --new-window --app="https://wiki.hypr.land/" & ;;
  *Arch*) setsid chromium --new-window --app="https://wiki.archlinux.org/title/Main_page" & ;;
  *Bash*) setsid chromium --new-window --app="https://devhints.io/bash" & ;;
  *Neovim*) setsid chromium --new-window --app="https://www.lazyvim.org/keymaps" & ;;
  *) main_menu ;;
  esac
}

system_menu() {
  case $(menu "System" "  Lock\n󰤄  Suspend\n󰜉  Restart\n󰐥  Shutdown") in
  *Lock*) hyprlock ;;
  *Suspend*) systemctl suspend ;;
  *Restart*) systemctl reboot ;;
  *Shutdown*) systemctl poweroff ;;
  *) main_menu ;;
  esac
}

main_menu() {
  case $(menu "Start" " Apps\n󰉉  Install\n󰉉  Uninstall\n󰧑  Learn\n  System\n- About") in
  *Apps*) rofi -show drun -show-icons -display-drun "Applications" ;;
  *Install*) install_menu ;;
  *Uninstall*) remove_menu ;;
  *Learn*) learn_menu ;;
  *System*) system_menu ;;
  *About*) alacritty --class=About --title=About -e bash -c 'fastfetch; read -n 1 -s' ;;
  esac
}

main_menu
